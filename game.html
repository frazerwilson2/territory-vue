<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Territory</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="game">

<div>
  // menus
<div v-for="(player, index) in game.players" v-if="index == turn">
<!-- Roster list -->
    // Roster
    <ul>
      <li v-for="(wrestler, index) in player.roster">{{findWrestler(wrestler).Name}} ({{findWrestler(wrestler).val}}) +{{findWrestler(wrestler).inc}}</li>
    </ul>
    // Gimmicks
    <ul>
      <li v-for="(gimmick, index) in player.gimmicks">{{findGimmick(gimmick).Name}}</li>
    </ul>
    // Stories
    <ul>
      <li v-for="(story, index) in player.stories" 
        @click="detailX(findStory(story).requires, findWrestler(player.roster[0]), findWrestler(player.roster[1]))">
        {{findStory(story).Name}}
        <ul v-if="findStory(story).active" style="background:#c0c2c3;">
        <li><em>({{listReqs(findStory(story).requires)}})</em></li>
        <li v-show="findStory(story).active"><span>Part {{findStory(story).current}} of {{findStory(story).lengthDur}}</span></li>
        <li v-if="findStory(story).competitors[0]">
          {{findWrestler(findStory(story).competitors[0]).Name}} / {{findWrestler(findStory(story).competitors[1]).Name}}
        </li>
        </ul>
      </li>
    </ul>
    // Legends 
    <ul>
      <li v-for="(legend, index) in player.legends">{{legend.Name}}</li>
    </ul>
    // TV {{player.tv}}
    // Arena {{player.arena}}
</div>
</div>

<div>

<div id="store" v-bind:class="{'show':showStore}">
  <a @click="openStore(false)">|X|</a>
  store<br>
  <h3>Roster</h3> 
  <ul><li v-for="wrestler in game.roster"><a @click="purchaseRoster(wrestler, findWrestler(wrestler).val)">{{findWrestler(wrestler).Name}} {{findWrestler(wrestler).val}}</a></li></ul>
  <h3>Story</h3>
  <div class="card" @click="purchaseStory()" v-bind:class="{'hide':checkNum(game.stories)}">Take story</div>
<!--   <ul><li v-for="story in game.stories">{{story}}</li></ul> -->
  <h3>Gimmicks</h3>
  <div v-show="game.gimmicks" class="card" @click="purchaseGimmick()" v-bind:class="{'hide':checkNum(game.gimmicks)}">Take gimmick</div>
<!--   <ul><li v-for="gimmick in game.gimmicks">{{findGimmick(gimmick).Name}}</li></ul> -->
  <h3>TV</h3>
  <div v-if="game.tv" class="card"><a @click="getTv()">TV CARDS ({{game.tv}} left)</a></div>
  <h3>Arena</h3>
  <div v-if="game.arena" class="card"><a @click="getArena()">ARENA ({{game.arena}} left)</a></div>
  <h3>Legends</h3>
  <ul><li v-for="legend in legendRoster"><a @click="purchaseLegend(legend, legend.val)">{{legend}}</a></li></ul>
</div>

<a @click="openStore(true)">store</a>

  <div v-for="(player, index) in game.players" v-if="index == turn">
    <div v-if="validate" class="errors">Errors</div>
    <h1>{{player.name}}</h1>{{player.tokens + ' token'}}
    
    <div v-for="(match, index) in player.matchcard">
      {{index}} {{match.ready}}
      <div class="select-card" v-bind:class="{ ready: match.ready}">
       <a @click="removeMatch(player, index)" style="float:right;">Remove M</a>
      <div class="card-holder" v-if="match.ready" style="float:left;" v-bind:class="{ setup: match.gimmick}">
        <div @click="openGimmick(index)" v-show="!match.gimmick">add gimmick</div>
        <div v-if="match.gimmick">{{findGimmick(match.gimmick).Name}} {{findWrestler(match.gimmickAffect).Name}}</div>
      </div>
      
      <div class="card-holder" v-bind:class="{ setup: match.competitors[0]}">
        <div @click="openRoster(index, 0)">+</div> 
        <div v-if="match.competitors[0]" v-bind:class="{'heel':findWrestler(match.competitors[0]).heelface === 'H', 'face':findWrestler(match.competitors[0]).heelface == 'F', 'champ':findWrestler(match.competitors[0]).isChamp}">
          {{findWrestler(match.competitors[0]).Name}}
          <span v-if="match.competitors[0] == match.winner" class="win">WIN</span>
          <a v-if="!match.winner || match.competitors[0] != match.winner" @click="setWinner(match, match.competitors[0], index)">Winner?</a>
        </div>
      </div>
      <div class="card-holder" v-bind:class="{ setup: match.competitors[1]}">
      <div @click="openRoster(index, 1)">+</div> 
        <div v-if="match.competitors[1]" v-bind:class="{'heel':findWrestler(match.competitors[1]).heelface === 'H', 'face':findWrestler(match.competitors[1]).heelface == 'F', 'champ':findWrestler(match.competitors[1]).isChamp}">
          {{findWrestler(match.competitors[1]).Name}}
          <span v-if="match.competitors[1] == match.winner" class="win">WIN</span>
          <a v-if="!match.winner || match.competitors[1] != match.winner" @click="setWinner(match, match.competitors[1], index)">Winner?</a>
        </div>
      </div>

      <div class="card-holder" v-if="match.ready" style="float:right;" v-bind:class="{ setup: match.story}">
        <div @click="openStory(index)" v-show="!match.story">add story</div>
        <div v-if="match.story">{{findStory(match.story).Name}}</div>
      </div>

      </div>
    </div>

      <div class="pop poproster" v-bind:class="{ active: popRoster }">
        <a @click="closePop()">|x|</a>
        <ul><li v-for="(wrestler, index) in player.temproster"><a @click="addToCard(index, wrestler)">{{findWrestler(wrestler).Name}} {{findWrestler(wrestler).heelface}}</a></li></ul>
      </div>

      <div class="pop popgimmick" v-bind:class="{ active: popGimmick }">
        <a @click="closePop()">|x|</a>
        <ul>
          <li v-for="(gimmick, index) in player.gimmicks" v-bind:class="{ hide: findGimmick(gimmick).type == 'TITLECHANGE' && titleCards == false }"><a @click="addGimmickCard(gimmick, index)">{{findGimmick(gimmick).Name}}</a></li>
        </ul>
      </div>

      <div class="pop popstory" v-bind:class="{ active: popStory }" v-if="player.matchcard[currentMatch]">
        <a @click="closePop()">|x|</a>
        <ul>
          <li 
          v-if="player.matchcard[currentMatch].ready" 
          v-for="(story, index) in player.stories"
          v-bind:class="{'hide':!summRes([findWrestler(player.matchcard[currentMatch].competitors[0]),findWrestler(player.matchcard[currentMatch].competitors[1])], findStory(story).requires) || myStory(story, player.matchcard[currentMatch].competitors)}">
          <a @click="addStoryCard(story, index)">{{findStory(story).Name}}</a>
          </li>
        </ul>
      </div>
  </div>
  <div v-if="turn == 'REVIEW'" class="summary">
    <h2>SUMMARY</h2> 
    <div v-for="result in summaryValues">
      <div v-for="(match, index) in result.matches">match {{index + 1}}: {{match}}</div>
      <div>Bonus: {{result.bonus}}</div>
      <div><strong>TOTAL: {{result.total}}</strong></div>
    </div>
  </div>
  <!-- Actions -->
  <div class="actions">
    <div v-if="turn == 'REVIEW'">
      <button @click="nextRound()">Next round</button>
    </div>
    <button @click="nextTurn()" v-if="turn != 'REVIEW'">Next</button>
  </div>
</div>

<div>
<h2>Round</h2>
<h3>{{game.round}}</h3>
<h4 v-for="(player, index) in game.players" v-if="index == turn">${{player.cash}}.00</h4>
</div>

<small>
  <hr>
	<div v-for="player in game.players">{{player}}<br></div>
<br>
      goal: {{game.goal}}<br>
      news: {{game.news}}<br>
      roster: {{game.roster}}<br>
      stories: {{game.stories}}<br>
      gimmicks: {{game.gimmicks}}<br>
      tv: {{game.tv}}<br>
      arena: {{game.arena}}<br>
      legends: {{legendRoster}}
</small>


</div>
  <!-- JS -->
  <script src="vue.js"></script>
  <script src="dist/game.js"></script>
</body>
</html>